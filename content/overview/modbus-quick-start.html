<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Modbus TCP EDS adapter quick start </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Modbus TCP EDS adapter quick start ">
    <meta name="generator" content="docfx 2.59.1.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../content/index.html" width="46">
                <img id="logo" src="../../content/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge Data Store"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="modbusQuickStart">
<h1 id="modbus-tcp-eds-adapter-quick-start">Modbus TCP EDS adapter quick start</h1>

<p>The Modbus TCP EDS adapter is a component of Edge Data Store that defines connections to and receives data from Modbus TCP capable devices. The Modbus TCP EDS adapter can connect to multiple devices by defining one instance of the adapter for each device. The EDS installation includes the Modbus TCP EDS adapter and the option to add a single Modbus TCP EDS adapter instance. Add additional instances after installation using the system components configuration. For more information about installation, see <a class="xref" href="../installation/install-edge-data-store.html">Install Edge Data Store</a>. To get started collecting data with an instance of the Modbus TCP EDS adapter, you need to configure the data source, which specifies the device connection, and the data selection, which specifies the data to collect.</p>
<p>The following diagram depicts the data flow of a single instance of Modbus TCP EDS adapter:</p>
<p><img src="../images/ModbusTCP.jpg" alt="Modbus TCP EDS" title="Modbus TCP EDS"></p>
<p>The adapter instance requests data from the Modbus TCP device and then the device sends its data. The adapter sends the collected data to the storage component where it is held until it can be egressed to permanent storage in PI Server or AVEVA Data Hub. The adapter instance can be configured from the device where EDS is installed, and EDS collects health information about the adapter that can be egressed.</p>
<h2 id="configure-a-modbus-tcp-data-source">Configure a Modbus TCP data source</h2>
<p>To configure a data source to connect a Modbus TCP device to the Modbus TCP EDS adapter instance:</p>
<ol>
<li><p>Using a text editor, copy the example below to create a file in JSON format to describe the location of the Modbus TCP data source.</p>
<pre><code class="lang-json">{
    &quot;Devices&quot;:
     [
         {
             &quot;Id&quot;: &quot;Device1&quot;,
             &quot;IpAddress&quot;: &quot;&lt;Modbus IP Address&gt;&quot;,
             &quot;Port&quot;: &lt;Port - usually 502&gt;,
         }
     ],
     &quot;ReconnectInterval&quot;: &quot;00:00:01&quot;,
     &quot;RequestTimeout&quot;: &quot;00:00:10&quot;,
     &quot;DelayBetweenRequests&quot;: &quot;00:00:00.5&quot;,
     &quot;MaxResponseDataLength&quot;: 125
}
</code></pre></li>
<li><p>Modify the values in the example to match your environment, including the IP address and port for the Modbus data source.</p>
</li>
<li><p>Save the file to the device with EDS installed using a file name based on the adapter instance name. For example, to use the adapter instance created during installation, which is <code>Modbus1</code>, name the file <code>Modbus1DataSource.json</code>.</p>
</li>
<li><p>Run the following command from the same directory where the file is located, updating the file name and destination in the script if needed.</p>
<div class="tabGroup" id="tabgroup_JN3rta8IoR">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR_tabid-1" role="tab" aria-controls="tabpanel_JN3rta8IoR_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">curl</a>
</li>
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR_tabid-2" role="tab" aria-controls="tabpanel_JN3rta8IoR_tabid-2" data-tab="tabid-2" tabindex="-1">EdgeCmd</a>
</li>
</ul>
<section id="tabpanel_JN3rta8IoR_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-bash">curl -d &quot;@Modbus1Datasource.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT http://localhost:5590/api/v1/configuration/Modbus1/Datasource
</code></pre></section>
<section id="tabpanel_JN3rta8IoR_tabid-2" role="tabpanel" data-tab="tabid-2" aria-hidden="true" hidden="hidden">
<pre><code class="lang-bash">edgecmd set dataSource -cid Modbus1 -file Modbus1DataSource.json
</code></pre></section>
</div>
</li>
</ol>
<p>When the command completes successfully, that is a <code>204</code> is returned, the Modbus TCP data source has been created. If a <code>400</code> error is returned, check the JSON file for errors. If a <code>404</code> or <code>500</code> error is returned, check that EDS is running on the device.</p>
<h2 id="configure-a-schedule">Configure a Schedule</h2>
<p>Data selection items will use schedules to perform their scans for data. To configure the schedule file, complete the following steps:</p>
<ol>
<li><p>Using a text editor, copy the example below to create a file in JSON format to define the schedule.</p>
<pre><code class="lang-json">[
    {
        &quot;Id&quot;: &quot;Schedule1&quot;,
        &quot;Period&quot;: &quot;00:00:01.500&quot;,
        &quot;Offset&quot;: &quot;00:02:03&quot;
    }
]
</code></pre></li>
<li><p>Modify the values in the example to match your environment.</p>
</li>
<li><p>Save the file to the device with EDS installed using a file name based on the adapter instance name. For example, to use the adapter instance created during installation, which is <code>Modbus1</code>, name the file <code>Modbus1Schedules.json</code>.</p>
</li>
<li><p>Run the following command from the same directory where the file is located, updating the file name and the endpoint URL in the script if needed.</p>
<div class="tabGroup" id="tabgroup_JN3rta8IoR-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR-1_tabid-1" role="tab" aria-controls="tabpanel_JN3rta8IoR-1_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">curl</a>
</li>
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR-1_tabid-2" role="tab" aria-controls="tabpanel_JN3rta8IoR-1_tabid-2" data-tab="tabid-2" tabindex="-1">EdgeCmd</a>
</li>
</ul>
<section id="tabpanel_JN3rta8IoR-1_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-bash">curl -d &quot;@Modbus1Schedules.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT http://localhost:5590/api/v1/configuration/Modbus1/Schedules
</code></pre></section>
<section id="tabpanel_JN3rta8IoR-1_tabid-2" role="tabpanel" data-tab="tabid-2" aria-hidden="true" hidden="hidden">
<pre><code class="lang-bash">edgecmd set schedules -cid Modbus1 -file Modbus1ConfigureSchedules.json
</code></pre></section>
</div>
</li>
</ol>
<h2 id="configure-modbus-tcp-data-selection">Configure Modbus TCP data selection</h2>
<p>After you create the data source file and schedule file, select the streams to store in EDS by configuring Modbus data selection. To configure the data selection file, complete the following steps:</p>
<ol>
<li><p>Using a text editor, copy the example below to create a file in JSON format to define each stream to ingress to EDS.</p>
<pre><code class="lang-json">[
    {
        &quot;DeviceId&quot; : &quot;Device1&quot;,
        &quot;Selected&quot;: true,
        &quot;UnitId&quot;: 1,
        &quot;RegisterType&quot;: 3,
        &quot;RegisterOffset&quot;: 1,
        &quot;DataTypeCode&quot;: 20,
        &quot;ConversionFactor&quot;: 2,
        &quot;ConversionOffset&quot;: 3.4,
        &quot;ScheduleId&quot;: &quot;Schedule1&quot;
    },
    {
        &quot;DeviceId&quot; : &quot;Device1&quot;,
        &quot;Selected&quot;: true,
        &quot;UnitId&quot;: 1,
        &quot;RegisterType&quot;: 3,
        &quot;RegisterOffset&quot;: 2,
        &quot;DataTypeCode&quot;: 20,
        &quot;ConversionFactor&quot;: 2,
        &quot;ConversionOffset&quot;: 3.4,
        &quot;ScheduleId&quot;: &quot;Schedule1&quot;
    }
]
</code></pre></li>
<li><p>Modify the values in the example to match your environment.</p>
</li>
<li><p>Save the file to the device with EDS installed using a file name based on the adapter instance name. For example, to use the adapter instance created during installation, which is <code>Modbus1</code>, name the file <code>Modbus1DataSelection.json</code>.</p>
</li>
<li><p>Run the following curl script from the same directory where the file is located, updating the file name and the endpoint URL in the script if needed.</p>
<div class="tabGroup" id="tabgroup_JN3rta8IoR-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR-2_tabid-1" role="tab" aria-controls="tabpanel_JN3rta8IoR-2_tabid-1" data-tab="tabid-1" tabindex="0" aria-selected="true">curl</a>
</li>
<li role="presentation">
<a href="#tabpanel_JN3rta8IoR-2_tabid-2" role="tab" aria-controls="tabpanel_JN3rta8IoR-2_tabid-2" data-tab="tabid-2" tabindex="-1">EdgeCmd</a>
</li>
</ul>
<section id="tabpanel_JN3rta8IoR-2_tabid-1" role="tabpanel" data-tab="tabid-1">
<pre><code class="lang-bash">curl -d &quot;@Modbus1Dataselection.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT http://localhost:5590/api/v1/configuration/Modbus1/Dataselection
</code></pre></section>
<section id="tabpanel_JN3rta8IoR-2_tabid-2" role="tabpanel" data-tab="tabid-2" aria-hidden="true" hidden="hidden">
<pre><code class="lang-bash">edgecmd set dataSelection -cid Modbus1 -file Modbus1DataSelection.json
</code></pre></section>
</div>
</li>
</ol>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/Edge-Data-Store-Docs/blob/main/content/overview/modbus-quick-start.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
