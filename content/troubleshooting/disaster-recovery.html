<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Disaster recovery </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Disaster recovery ">
    <meta name="generator" content="docfx 2.59.1.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../content/index.html" width="46">
                <img id="logo" src="../../content/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge Data Store"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="disasterRecovery">
<h1 id="disaster-recovery">Disaster recovery</h1>

<p>If a device with Edge Data Store installed fails, use the following procedures to recover data from the failed device and restore it to a new device. The disaster recovery process is similar for both Windows and Linux systems and includes the following steps:</p>
<ul>
<li><p>Back up the EDS data from the failed device to another location.</p>
</li>
<li><p>Install EDS on a new device. For instructions, see <a class="xref" href="../installation/install-edge-data-store.html">Install Edge Data Store</a>.</p>
</li>
<li><p>Move the backed-up data to the new device.</p>
</li>
<li><p>Restore the backed-up data files to the new device.</p>
</li>
<li><p>Reenter credentials.</p>
</li>
</ul>
<h2 id="windows-recovery">Windows recovery</h2>
<p>Use the following procedures to recover EDS data from a Windows device. You need administrative access on the device to successfully restore on a Windows system.</p>
<h3 id="create-a-backup-of-eds-data-from-the-failed-device">Create a backup of EDS data from the failed device</h3>
<p>To create a backup of data from the failed device:</p>
<ol>
<li><p>If your device is still able to boot, verify that Edge Data Store service has stopped. Use the Windows Task Manager to stop the Edge Data Store service.</p>
</li>
<li><p>Locate the storage and configuration files.</p>
<p><strong>Note:</strong> Windows storage and configuration files are stored in the following locations:</p>
<ul>
<li><p><code>C:\ProgramData\OSIsoft\EdgeDataStore\Configuration</code></p>
</li>
<li><p><code>C:\ProgramData\OSIsoft\EdgeDataStore\Storage</code></p>
</li>
</ul>
<p>Stream data files are stored in the following locations:</p>
<ul>
<li><p>Default namespace: <code>C:\ProgramData\OSIsoft\EdgeDataStore\Storage\data\default\default</code></p>
</li>
<li><p>Diagnostics namespace: <code>C:\ProgramData\OSIsoft\EdgeDataStore\Storage\data\default\diagnostics</code></p>
</li>
</ul>
<p>The <code>ProgramData</code> folder is typically hidden; to view it, go to the <strong>View</strong> tab in <strong>Windows Explorer</strong> and select the <strong>Hidden Items</strong> checkbox.</p>
</li>
<li><p>Create a <code>zip</code> or <code>tar</code> file containing the storage and configuration directories, and move it to a USB device or other safe location. File transfer can be done with WinSCP, SFTP, or external device.</p>
</li>
</ol>
<h3 id="delete-default-storage-and-configuration-folders">Delete default storage and configuration folders</h3>
<p>When EDS is installed on the new device, the new system has a default configuration. To delete the default storage and configuration folders on the new device:</p>
<ol>
<li><p>Use the Windows Task Manager to stop the Edge Data Store service.</p>
</li>
<li><p>Once the service has stopped, navigate to the <code>C:\ProgramData\OSIsoft\EdgeDataStore</code> directory, and delete the default storage and configuration folders from the new device.</p>
</li>
</ol>
<h3 id="restore-backed-up-data-files">Restore backed up data files</h3>
<p>To restore the data files on the new device:</p>
<ol>
<li><p>Copy or unzip the backup storage and configuration files into the <code>C:\ProgramData\OSIsoft\EdgeDataStore</code> directory.</p>
<p><strong>Note:</strong> The <code>C:</code> drive may not be the default drive letter of your system. Refer to My Computer, This PC, or open a command prompt to verify the default drive letter.</p>
</li>
<li><p>Use the Windows Task Manager to restart the Edge Data Store service.</p>
</li>
</ol>
<h3 id="reenter-credentials">Reenter credentials</h3>
<p>All credentials are encrypted for security purposes, so they cannot be copied or transferred. After the the storage and configuration files are copied to the new system, and the service has started, follow these steps to enter credentials:</p>
<ol>
<li><p>Reenter the credentials for the operating system using API calls.</p>
</li>
<li><p>After updating, restart the Edge Data Store service.</p>
</li>
</ol>
<p>The new EDS device runs as the previous device, and contains all the data up to the point when the previous device failed.</p>
<h2 id="linux-recovery">Linux recovery</h2>
<p>Use the following procedures to recover EDS data from a Linux device. Root access on the Linux device is required.</p>
<h3 id="create-a-backup-of-eds-data-from-the-failed-device-1">Create a backup of EDS data from the failed device</h3>
<p>To create a backup of data from the failed device:</p>
<ol>
<li><p>If your device is still able to boot, open a terminal window and verify that Edge Data Store service has stopped using the following command:</p>
<pre><code>sudo systemctl stop osisoft.edgedatastore
</code></pre></li>
<li><p>Locate the storage and configuration files.</p>
<p><strong>Note:</strong> Linux storage and configuration files are stored in the following locations:</p>
<ul>
<li><p><code>/usr/share/OSIsoft/EdgeDataStore/Configuration</code></p>
</li>
<li><p><code>/usr/share/OSIsoft/EdgeDataStore/Storage</code></p>
</li>
</ul>
<p>Stream data files are stored in the following locations:</p>
<ul>
<li><p>Default namespace: <code>/usr/share/OSIsoft/EdgeDataStore/Storage/data/default/default</code></p>
</li>
<li><p>Diagnostics namespace: <code>/usr/share/OSIsoft/EdgeDataStore/Storage/data/default/diagnostics</code></p>
</li>
</ul>
</li>
<li><p>Create a zip or tar file containing the storage and configuration directories, and move it to a USB device or other safe location. Use WinSCP, SFTP, or the external device to transfer the file.</p>
<p><strong>Note:</strong> Using the <code>cp</code> command may result in a change in file ownership to the current user.</p>
</li>
</ol>
<h3 id="move-the-files-to-the-new-device">Move the files to the new device</h3>
<p>When EDS is installed on the new device, the new system has a default configuration. To copy the backed up storage and configuration folders to the new device:</p>
<ol>
<li><p>Open a terminal window and stop the Edge Data Store service using the following command:</p>
<pre><code>sudo systemctl stop osisoft.edgedatastore
</code></pre></li>
<li><p>Once the service has stopped, navigate to the <code>/usr/share/OSIsoft/EdgeDataStore</code> directory and extract the zip or tar file in that directory using WinSCP, SFTP, or external device.</p>
</li>
</ol>
<h3 id="restore-backed-up-data-files-1">Restore backed up data files</h3>
<p>To restore the data files on the new device:</p>
<ol>
<li><p>Delete the default storage and configuration folders from the <code>/usr/share/OSIsoft/EdgeDataStore</code> directory.</p>
</li>
<li><p>Copy or unzip the backup storage and configuration files into the <code>EdgeDataStore</code> directory.</p>
</li>
<li><p>If the ownership of the two directories does not match, update it to <code>edgedatastore</code> for the user and group.</p>
</li>
<li><p>Start the Edge Data Store service with the following command:</p>
<pre><code>sudo systemctl start osisoft.edgedatastore
</code></pre></li>
<li><p>Verify that EDS is running with the following command:</p>
<pre><code>sudo systemctl status osisoft.edgedatastore
</code></pre><p><strong>Note:</strong> Default directory permissions are set to <code>755</code>, and each subsequent file is <code>644</code>. If you do not use tar it is possible to have permission issues with the recovery files. Tar matches via string name rather than the account ID/UID.</p>
</li>
</ol>
<h3 id="reenter-credentials-1">Reenter credentials</h3>
<p>All credentials are encrypted for security purposes, so they cannot be copied or transferred. After the the storage and configuration files are copied to the new system, and the service has started, follow these steps to enter credentials:</p>
<ol>
<li><p>Re-enter the credentials for the operating system using API calls.</p>
</li>
<li><p>After updating, restart the Edge Data Store service.</p>
</li>
</ol>
<p>The new EDS device runs as the previous device, and contains all the data up to the point when the previous device failed.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/Edge-Data-Store-Docs/blob/main/content/troubleshooting/disaster-recovery.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
